<!doctype html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>C·∫ßn Th∆° Trip</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    <link
      href="https://fonts.googleapis.com/css2?family=Be+Vietnam+Pro:wght@300;400;500;600;700;900&display=swap"
      rel="stylesheet" />
    <style>
      /* <!-- Chosen Palette: Afternoon Sun & Neon Night --> */
      /* <!-- Application Structure: Updated Day 0 timeline for 13:00 departure. --> */

      body {
        font-family: 'Be Vietnam Pro', sans-serif;
        background-color: #f8fafc;
        color: #0f172a;
      }

      .chart-container {
        position: relative;
        width: 100%;
        max-width: 600px;
        margin-left: auto;
        margin-right: auto;
        height: 300px;
        max-height: 400px;
      }

      .glass-panel {
        background: rgba(255, 255, 255, 0.95);
        backdrop-filter: blur(8px);
        border: 1px solid #e2e8f0;
      }

      .food-card-img {
        transition: transform 0.5s ease;
        width: 100%;
        height: 100%;
        object-fit: cover;
      }
      .food-card:hover .food-card-img {
        transform: scale(1.05);
      }

      .img-skeleton {
        background-color: #cbd5e1;
        animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
      }
      @keyframes pulse {
        0%,
        100% {
          opacity: 1;
        }
        50% {
          opacity: 0.5;
        }
      }

      /* Checkbox custom style */
      .biker-check:checked + label {
        text-decoration: line-through;
        color: #94a3b8;
      }

      /* Optional Item Styling (Dashed Border) */
      .item-optional {
        border-style: dashed !important;
        background-color: #f1f5f9 !important;
        opacity: 0.9;
      }
      .item-optional::after {
        content: '(Tu·ª≥ ch·ªçn)';
        font-size: 0.7rem;
        color: #64748b;
        display: block;
        margin-top: 4px;
        font-style: italic;
      }

      /* Chatwidget Styles */
      .chat-widget {
        position: fixed;
        bottom: 20px;
        right: 20px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
      }

      .chat-button {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        background: linear-gradient(135deg, #f59e0b 0%, #d97706 100%); /* Amber for 1PM Sun */
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 4px 15px rgba(217, 119, 6, 0.4);
        cursor: pointer;
        transition: transform 0.3s ease;
        font-size: 30px;
      }

      .chat-button:hover {
        transform: scale(1.1);
      }

      .chat-window {
        width: 350px;
        height: 500px;
        background: white;
        border-radius: 20px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        margin-bottom: 20px;
        display: none;
        flex-direction: column;
        overflow: hidden;
        border: 1px solid #e2e8f0;
      }

      .chat-header {
        background: #78350f;
        color: white;
        padding: 15px;
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .chat-messages {
        flex-grow: 1;
        padding: 15px;
        overflow-y: auto;
        background: #fffbeb;
        display: flex;
        flex-direction: column;
        gap: 10px;
      }

      .message {
        max-width: 80%;
        padding: 10px 15px;
        border-radius: 15px;
        font-size: 14px;
        line-height: 1.4;
      }

      .message.user {
        background: #d97706;
        color: white;
        align-self: flex-end;
        border-bottom-right-radius: 2px;
      }
      .message.ai {
        background: white;
        color: #1e293b;
        align-self: flex-start;
        border-bottom-left-radius: 2px;
        box-shadow: 0 2px 5px rgba(0, 0, 0, 0.05);
      }

      .chat-input-area {
        padding: 15px;
        background: white;
        border-top: 1px solid #e2e8f0;
        display: flex;
        gap: 10px;
      }

      .chat-input-area input {
        flex-grow: 1;
        padding: 10px;
        border: 1px solid #cbd5e1;
        border-radius: 20px;
        outline: none;
      }

      .typing-indicator span {
        display: inline-block;
        width: 6px;
        height: 6px;
        background-color: #94a3b8;
        border-radius: 50%;
        animation: typing 1s infinite ease-in-out;
        margin-right: 3px;
      }
      @keyframes typing {
        0%,
        100% {
          transform: translateY(0);
        }
        50% {
          transform: translateY(-5px);
        }
      }

      /* Modal for Food Review */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        z-index: 2000;
        display: none;
        align-items: center;
        justify-content: center;
        backdrop-filter: blur(4px);
      }
      .modal-content {
        background: white;
        width: 90%;
        max-width: 500px;
        border-radius: 20px;
        padding: 25px;
        position: relative;
        max-height: 80vh;
        overflow-y: auto;
      }

      /* Button Icon Styles */
      .btn-icon {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        transition: all 0.2s;
      }
      .btn-icon:hover {
        transform: translateY(-1px);
      }
    </style>
  </head>
  <body class="antialiased min-h-screen flex flex-col">
    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-white/95 backdrop-blur shadow-sm border-b border-gray-200">
      <div class="max-w-6xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between h-16 items-center">
          <div class="flex items-center gap-2">
            <span class="text-2xl">üèçÔ∏è</span>
            <div class="text-xl font-bold text-slate-800 tracking-tight">
              Moto<span class="text-amber-600">Trip</span>
            </div>
          </div>
          <div class="hidden md:flex space-x-8">
            <button
              onclick="scrollToSection('overview')"
              class="text-slate-600 hover:text-amber-600 font-bold transition">
              T·ªïng Quan
            </button>
            <button
              onclick="scrollToSection('itinerary')"
              class="text-slate-600 hover:text-amber-600 font-bold transition">
              L·ªãch Tr√¨nh
            </button>
            <button
              onclick="scrollToSection('food')"
              class="text-slate-600 hover:text-amber-600 font-bold transition">
              ƒÇn Ch∆°i
            </button>
            <button
              onclick="scrollToSection('checklist')"
              class="text-slate-600 hover:text-amber-600 font-bold transition">
              Ki·ªÉm Tra Xe
            </button>
          </div>
          <button class="md:hidden text-2xl" onclick="toggleMobileNav()">‚ò∞</button>
        </div>
      </div>
      <div id="mobile-nav" class="hidden md:hidden bg-white border-b border-gray-200 p-4 space-y-3">
        <button
          onclick="scrollToSection('overview')"
          class="block w-full text-left text-slate-700 font-bold">
          T·ªïng Quan
        </button>
        <button
          onclick="scrollToSection('itinerary')"
          class="block w-full text-left text-slate-700 font-bold">
          L·ªãch Tr√¨nh
        </button>
        <button
          onclick="scrollToSection('food')"
          class="block w-full text-left text-slate-700 font-bold">
          ƒÇn Ch∆°i
        </button>
        <button
          onclick="scrollToSection('checklist')"
          class="block w-full text-left text-slate-700 font-bold">
          Ki·ªÉm Tra Xe
        </button>
      </div>
    </nav>

    <!-- Hero Section -->
    <section id="overview" class="pt-10 pb-8 px-4 sm:px-6 lg:px-8 max-w-6xl mx-auto w-full">
      <div class="text-center mb-10">
        <span
          class="inline-block py-1 px-3 rounded bg-amber-100 text-amber-800 text-xs font-black uppercase tracking-wider mb-3"
          >Trip 3 Ng∆∞·ªùi - 2 Xe</span
        >
        <h1 class="text-4xl sm:text-6xl font-black text-slate-900 mb-6 tracking-tighter">
          PH∆Ø·ª¢T
          <span class="text-transparent bg-clip-text bg-gradient-to-r from-amber-600 to-orange-500"
            >C·∫¶N TH∆†</span
          >
        </h1>

        <p class="text-lg text-slate-700 max-w-2xl mx-auto font-medium leading-relaxed">
          Xu·∫•t ph√°t: <span class="font-bold text-amber-600">13:00 ng√†y 30/1</span>. <br />
          Tranh th·ªß t·ªõi s·ªõm nh·∫≠n ph√≤ng, ngh·ªâ ng∆°i ƒë·ªÉ 31/1 ch∆°i tr·ªçn v·∫πn.
        </p>
      </div>

      <!-- Quick Stats Cards -->
      <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mb-12">
        <div class="bg-white p-6 rounded-xl border-l-4 border-amber-500 shadow-sm">
          <div class="text-3xl mb-2">‚òÄÔ∏è</div>
          <h3 class="font-bold text-slate-800 text-lg">Ch·∫°y N·∫Øng 13H</h3>
          <p class="text-slate-600 text-sm mt-1">
            ƒêo·∫°n ƒë·∫ßu s·∫Ω n·∫Øng. Nh·ªõ m·∫∑c √°o kho√°c d√†y, k√≠nh r√¢m v√† u·ªëng n∆∞·ªõc ƒë·ªß.
          </p>
        </div>
        <div class="bg-white p-6 rounded-xl border-l-4 border-blue-500 shadow-sm">
          <div class="text-3xl mb-2">üèÅ</div>
          <h3 class="font-bold text-slate-800 text-lg">ƒê·∫øn S·ªõm 17H30</h3>
          <p class="text-slate-600 text-sm mt-1">
            Check-in xong tr·ªùi v·ª´a m√°t. K·ªãp th·ªùi gian ƒëi d·∫°o Ninh Ki·ªÅu bu·ªïi t·ªëi.
          </p>
        </div>
        <div class="bg-white p-6 rounded-xl border-l-4 border-emerald-500 shadow-sm">
          <div class="text-3xl mb-2">üí∞</div>
          <h3 class="font-bold text-slate-800 text-lg">Chia 3 C·ª±c R·∫ª</h3>
          <p class="text-slate-600 text-sm mt-1">
            D∆∞ d·∫£ ƒÉn u·ªëng t·∫°i c√°c qu√°n hot: Ph·ªë N∆∞·ªõng 102, L·∫©u V·ªãt...
          </p>
        </div>
      </div>
    </section>

    <!-- Itinerary Section -->
    <section id="itinerary" class="py-12 bg-white w-full">
      <div class="max-w-5xl mx-auto px-4 sm:px-6">
        <div class="mb-10 text-center">
          <h2 class="text-3xl font-black text-slate-900 uppercase">L·ªãch Tr√¨nh</h2>
          <p class="text-slate-500 mt-1">B·∫•m v√†o c√°c tab ƒë·ªÉ xem chi ti·∫øt.</p>
        </div>

        <!-- Tabs -->
        <div class="flex justify-center mb-8 space-x-2 sm:space-x-4 overflow-x-auto">
          <button
            onclick="switchDay(0)"
            id="tab-day0"
            class="px-4 py-2 rounded font-bold transition bg-amber-600 text-white shadow-md border-2 border-amber-600 whitespace-nowrap">
            Chi·ªÅu 30/1
          </button>
          <button
            onclick="switchDay(1)"
            id="tab-day1"
            class="px-4 py-2 rounded font-bold transition bg-slate-100 text-slate-600 border-2 border-transparent whitespace-nowrap">
            Ng√†y 31/1
          </button>
          <button
            onclick="switchDay(2)"
            id="tab-day2"
            class="px-4 py-2 rounded font-bold transition bg-slate-100 text-slate-600 border-2 border-transparent whitespace-nowrap">
            Ng√†y 1/2
          </button>
          <button
            onclick="switchDay(3)"
            id="tab-day3"
            class="px-4 py-2 rounded font-bold transition bg-slate-100 text-slate-600 border-2 border-transparent whitespace-nowrap">
            S√°ng 2/2
          </button>
        </div>

        <div
          class="relative border-l-4 border-slate-200 ml-4 md:ml-6 pl-8 space-y-8"
          id="timeline-content">
          <!-- Content injected via JS -->
        </div>
      </div>
    </section>

    <!-- Food Section -->
    <section id="food" class="py-12 bg-slate-50 w-full">
      <div class="max-w-6xl mx-auto px-4 sm:px-6">
        <div class="text-center mb-10">
          <h2 class="text-3xl font-black text-slate-900 uppercase">ƒê·ªãa ƒêi·ªÉm ƒê√£ Ch·ªçn</h2>
          <div class="flex justify-center gap-2 mt-5">
            <button
              onclick="filterFood('all')"
              class="food-filter-btn px-5 py-2 rounded font-bold bg-slate-800 text-white transition shadow hover:bg-slate-700">
              T·∫•t c·∫£
            </button>
            <button
              onclick="filterFood('main')"
              class="food-filter-btn px-5 py-2 rounded font-bold bg-white text-slate-600 border border-slate-300 transition hover:bg-slate-100">
              ƒÇn Ch√≠nh/Nh·∫≠u
            </button>
            <button
              onclick="filterFood('snack')"
              class="food-filter-btn px-5 py-2 rounded font-bold bg-white text-slate-600 border border-slate-300 transition hover:bg-slate-100">
              ƒÇn V·∫∑t
            </button>
          </div>
        </div>

        <!-- Grid -->
        <div id="food-grid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Injected via JS -->
        </div>
      </div>
    </section>

    <!-- Budget Section -->
    <section class="py-12 bg-white w-full border-t border-slate-200">
      <div class="max-w-4xl mx-auto px-4 sm:px-6">
        <h2 class="text-2xl font-bold text-slate-900 text-center mb-4">T·ªïng Chi Ph√≠ (3 Ng∆∞·ªùi)</h2>
        <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-sm">
          <div class="chart-container mx-auto">
            <canvas id="budgetChart"></canvas>
          </div>
        </div>
      </div>
    </section>

    <!-- Biker Checklist -->
    <section id="checklist" class="py-8 bg-slate-900 text-white w-full">
      <div class="max-w-4xl mx-auto px-4 sm:px-6">
        <h2 class="text-2xl font-bold mb-6 flex items-center gap-3">
          <span>üîß</span> B·∫£o D∆∞·ª°ng 2 Xe (Quan Tr·ªçng)
        </h2>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div
            class="flex items-center gap-3 p-3 bg-slate-800 rounded border border-slate-700 hover:border-amber-500 transition cursor-pointer"
            onclick="document.getElementById('check1').click()">
            <input type="checkbox" id="check1" class="biker-check w-5 h-5 accent-amber-500" />
            <label for="check1" class="cursor-pointer select-none"
              >ƒê·ªï ƒë·∫ßy b√¨nh xƒÉng tr∆∞·ªõc khi xu·∫•t ph√°t</label
            >
          </div>
          <div
            class="flex items-center gap-3 p-3 bg-slate-800 rounded border border-slate-700 hover:border-amber-500 transition cursor-pointer"
            onclick="document.getElementById('check2').click()">
            <input type="checkbox" id="check2" class="biker-check w-5 h-5 accent-amber-500" />
            <label for="check2" class="cursor-pointer select-none"
              >2 G∆∞∆°ng chi·∫øu h·∫≠u (Mi·ªÅn T√¢y b·∫Øt g·∫Øt)</label
            >
          </div>
          <div
            class="flex items-center gap-3 p-3 bg-slate-800 rounded border border-slate-700 hover:border-amber-500 transition cursor-pointer"
            onclick="document.getElementById('check3').click()">
            <input type="checkbox" id="check3" class="biker-check w-5 h-5 accent-amber-500" />
            <label for="check3" class="cursor-pointer select-none">Ki·ªÉm tra l·ªëp xe & th·∫Øng</label>
          </div>
          <div
            class="flex items-center gap-3 p-3 bg-slate-800 rounded border border-slate-700 hover:border-amber-500 transition cursor-pointer"
            onclick="document.getElementById('check4').click()">
            <input type="checkbox" id="check4" class="biker-check w-5 h-5 accent-amber-500" />
            <label for="check4" class="cursor-pointer select-none"
              >√Åo kho√°c d√†y, k√≠nh r√¢m (ƒêi 13h r·∫•t n·∫Øng)</label
            >
          </div>
        </div>
      </div>
    </section>

    <!-- Chat Widget -->
    <div class="chat-widget">
      <div class="chat-window" id="chatWindow">
        <div class="chat-header">
          <div class="flex items-center gap-2">
            <span class="text-xl">ü§†</span>
            <div>
              <div class="font-bold text-sm">Th·ªï ƒê·ªãa C·∫ßn Th∆° AI</div>
              <div class="text-xs text-amber-200">Online</div>
            </div>
          </div>
          <button onclick="toggleChat()" class="text-white hover:text-amber-400">‚úï</button>
        </div>
        <div class="chat-messages" id="chatMessages">
          <div class="message ai">
            Ch√†o 3 ƒë·∫°i ca! Xu·∫•t ph√°t 1h tr∆∞a th√¨ h∆°i n·∫Øng nha, nh·ªõ tr√πm k√≠n m√≠t v√†o. T·ªõi C·∫ßn Th∆° t·∫ßm
            chi·ªÅu m√°t l√† ƒë·∫πp. C·∫ßn g√¨ h√∫ tui! üçª
          </div>
        </div>
        <div class="chat-input-area">
          <input
            type="text"
            id="userQuery"
            placeholder="H·ªèi g√¨ ƒë√≥..."
            onkeypress="handleKeyPress(event)" />
          <button
            onclick="sendMessage()"
            class="bg-amber-600 text-white p-2 rounded-full hover:bg-amber-700 w-10 h-10 flex items-center justify-center">
            ‚û§
          </button>
        </div>
      </div>
      <div class="chat-button" onclick="toggleChat()">üí¨</div>
    </div>

    <!-- Modal for Food Review -->
    <div class="modal-overlay" id="reviewModal" onclick="closeReview(event)">
      <div class="modal-content">
        <div class="flex justify-between items-center mb-4 border-b pb-2">
          <h3 class="text-xl font-bold text-slate-800" id="reviewTitle">Review M√≥n ƒÇn</h3>
          <button onclick="closeReview(null)" class="text-slate-500 hover:text-red-500 text-2xl">
            √ó
          </button>
        </div>
        <div id="reviewContent" class="text-slate-600 leading-relaxed">
          <!-- Content from AI -->
        </div>
      </div>
    </div>

    <footer class="bg-slate-900 text-slate-400 py-8 text-center mt-auto">
      <p class="mb-2 text-clg text-white font-bold">Th∆∞·ª£ng L·ªô B√¨nh An nh√© 3 Bro! üèçÔ∏èüí®</p>
    </footer>

    <script>
      // --- Gemini API Configuration ---
      const apiKey = 'AIzaSyC0LXyuNgZuYO8fw5G4gxKlhl9vao8KRuk';

      // Helper to call Gemini
      async function callGemini(prompt, systemInstruction = '') {
        if (!apiKey) {
          return 'Ch∆∞a c√≥ API Key. (Ch·∫ø ƒë·ªô gi·∫£ l·∫≠p: ƒêi 13h nh·ªõ u·ªëng n∆∞·ªõc nhi·ªÅu nha ƒë·∫°i ca!)';
        }
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
        const payload = {
          contents: [{ parts: [{ text: prompt }] }],
          systemInstruction: { parts: [{ text: systemInstruction }] }
        };
        try {
          const response = await fetch(url, {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(payload)
          });
          if (!response.ok) throw new Error('API Error');
          const data = await response.json();
          return data.candidates?.[0]?.content?.parts?.[0]?.text || 'L·ªói m·∫°ng r·ªìi ƒë·∫°i ca ∆°i!';
        } catch (error) {
          console.error('Gemini Error:', error);
          return 'L·ªói k·∫øt n·ªëi v·ªá tinh.';
        }
      }

      // --- Custom Data ---
      const foodData = [
        {
          name: 'L·∫©u V·ªãt C√¢y Tr·ª©ng C√°',
          type: 'main',
          address: 'ƒê∆∞·ªùng Ho√†ng Qu·ªëc Vi·ªát (g·∫ßn Th·ªët N·ªët)',
          mapLink:
            'https://www.google.com/maps/search/?api=1&query=L·∫©u+v·ªãt+n·∫•u+chao+c√¢y+tr·ª©ng+c√°+c·∫ßn+th∆°',
          tiktok:
            'https://www.tiktok.com/@didauofficial/video/7323148355784248578?is_from_webapp=1&sender_device=pc&web_id=7598236609910621704',
          desc: 'M√≥n ƒÉn h·ªìi s·ª©c c·ª±c t·ªët cho 3 anh em. V·ªãt m·ªÅm, chao b√©o.',
          img: 'https://scontent.fhan3-2.fna.fbcdn.net/v/t39.30808-6/496154613_2485025641831032_2422235189345591083_n.jpg?_nc_cat=107&ccb=1-7&_nc_sid=aa7b47&_nc_ohc=F2Jp_vudC3MQ7kNvwG1K3jR&_nc_oc=AdkFvN0rag8nTahKOSLQc68h55gjgAqb_6azfktbTWhkWwPs3_o-eGLOYs_BGs_5oqI&_nc_zt=23&_nc_ht=scontent.fhan3-2.fna&_nc_gid=b5gJzAYy3ls4e1q-yqtbEw&oh=00_AfrpZ5mwBq7w7wXk1Niq5QKUWK24OQHOZ0RptTe-K8vM7Q&oe=697A0325'
        },
        {
          name: 'Nem N∆∞·ªõng C√¥ Thu',
          type: 'main',
          address: 'ƒê∆∞·ªùng Ph·∫°m H√πng, L√™ B√¨nh, C√°i RƒÉng',
          mapLink: 'https://www.google.com/maps/search/?api=1&query=Nem+n∆∞·ªõng+C√°i+RƒÉng+C√¥+Thu',
          tiktok:
            'https://www.tiktok.com/@loanhquanhmientay/video/7362160315330481424?is_from_webapp=1&sender_device=pc&web_id=7598236609910621704',
          desc: 'ƒê·∫∑c s·∫£n C√°i RƒÉng. Cu·ªën nem n√≥ng v·ªõi b√°nh h·ªèi.',
          img: 'https://dantocmiennui-media.baotintuc.vn/images/57c5aab70c5efc5a98d240302ffc6edbcf0533580b040d14fdc8bc33ffa64029cb69bc977eb508fbc9a95eef3e2501d1a1953ec9b67cc2ae3bb6fb8a4fddd937e2f70135d22d21a88dc4a7c7b5fcf1dd/99adb57ced9be9eb6f949275625d8ce6-1.jpg'
        },
        {
          name: 'Ph·ªë N∆∞·ªõng 102',
          type: 'main',
          address: '16B Tr·∫ßn Ho√†ng Na, C·∫ßn Th∆°',
          mapLink: 'https://www.google.com/maps/search/?api=1&query=Ph·ªë+N∆∞·ªõng+102+C·∫ßn+Th∆°',
          tiktok:
            'https://www.tiktok.com/@vovulamreview/video/7511191213362433288?is_from_webapp=1&sender_device=pc&web_id=7598236609910621704',
          desc: 'Qu√°n nh·∫≠u b√¨nh d√¢n, kh√¥ng gian r·ªông r√£i, th√≠ch h·ª£p tƒÉng 2.',
          img: 'https://lh3.googleusercontent.com/p/AF1QipNZAeIE5TFYnWN44QqnmJi3EXLisF2svBWBMK8l=s1360-w1360-h1020-rw'
        },
        {
          name: 'L·∫©u M·∫Øm Ki·ªÅu Trinh',
          type: 'main',
          address: '26 Tr·∫ßn Kh√°nh D∆∞, C·∫ßn Th∆°',
          mapLink: 'https://www.google.com/maps/search/?api=1&query=L·∫©u+m·∫Øm+Ki·ªÅu+Trinh+C·∫ßn+Th∆°',
          tiktok: 'https://www.tiktok.com/@embedichoi0/video/7593964647628197138',
          desc: 'L·∫©u m·∫Øm ƒë·∫≠m ƒë√†, chu·∫©n v·ªã mi·ªÅn T√¢y.',
          img: 'https://lh3.googleusercontent.com/gps-cs-s/AHVAweoJ8lzrl0GGegX9VPoKFrE5xIAPOhzfH4-s21DjQS18SzlxTyubWh50cb1u51zZ_hIIxaUwzW3-DeXBhu4kgEfU-39B2V_5Uo_2Eyd_dgvzHdo7p7hCO3QQ-GUsBI87G-OUrIw36A=s1360-w1360-h1020-rw'
        },
        {
          name: 'B√°nh C·ªëng C√¥ √öt',
          type: 'snack',
          address: '86/38 L√Ω T·ª± Tr·ªçng, C·∫ßn Th∆°',
          mapLink: 'https://maps.app.goo.gl/dZbWcMeZjFBkchsh9',
          tiktok: 'https://www.tiktok.com/@phukien65cantho/video/7542728369830399239',
          desc: 'B√°nh c·ªëng gi√≤n r·ª•m trong h·∫ªm nh·ªè.',
          img: 'https://canthoriviu.vn/wp-content/uploads/2023/05/1_1753_60118284-1-1.jpeg'
        },
        {
          name: 'Pizza H·ªß Ti·∫øu',
          type: 'snack',
          address: 'L√≤ S√°u Ho√†i / Ch·ª£ N·ªïi',
          mapLink: 'https://maps.app.goo.gl/CBn8JDk5cusrmmaF6',
          tiktok: 'https://www.tiktok.com/@dulichcantho02/video/7491974815553801479',
          desc: 'H·ªß ti·∫øu chi√™n gi√≤n ƒÉn nh∆∞ snack.',
          img: 'https://vcdn1-dulich.vnecdn.net/2022/01/06/A-nh-3-4785-1628743117-3153-1641453317.jpg?w=680&h=0&q=100&dpr=2&fit=crop&s=TW4nEyCRGrEfJUig6VJtEA'
        },
        {
          name: 'Chu·ªëi N·∫øp N∆∞·ªõng',
          type: 'snack',
          address: 'Ch·ª£ C√°i Kh·∫ø, Nguy·ªÖn ƒê·ª©c C·∫£nh',
          mapLink: 'https://www.google.com/maps/search/?api=1&query=Ch·ª£+C√°i+Kh·∫ø+C·∫ßn+Th∆°',
          tiktok:
            'https://www.tiktok.com/@trangduongdaily/video/7584051606354791687?is_from_webapp=1&sender_device=pc&web_id=7598236609910621704',
          desc: 'Chu·ªëi b·ªçc n·∫øp n∆∞·ªõng th∆°m l·ª´ng c·ªët d·ª´a.',
          img: 'https://cdn.tgdd.vn/Files/2018/04/26/1084640/chuoi-boc-nep-nuong-thom-ngon-kho-cuong-ma-cuc-de-lam-1-760x367.jpg'
        }
      ];

      // --- ITINERARY DATA ---
      const itineraryData = {
        0: [
          // Day 0: 30/1
          {
            time: '13:00',
            title: 'Xu·∫•t ph√°t (SG)',
            desc: 'Tr·ªùi n·∫Øng 1h tr∆∞a. Nh·ªõ m·∫∑c k√≠n, ƒëeo k√≠nh r√¢m. Ch·∫°y c·∫©n th·∫≠n.',
            icon: '‚òÄÔ∏è'
          },
          {
            time: '15:30',
            title: 'Ngh·ªâ Ch√¢n Ti·ªÅn Giang',
            desc: 'Ngh·ªâ v√µng, u·ªëng n∆∞·ªõc m√≠a/d·ª´a t∆∞∆°i gi·∫£i nhi·ªát t·∫ßm 30p.',
            icon: 'üõë'
          },
          {
            time: '17:30',
            title: 'Check-in C·∫ßn Th∆°',
            desc: 'T·ªõi n∆°i l√∫c tr·ªùi d·ªãu m√°t. Nh·∫≠n ph√≤ng, t·∫Øm r·ª≠a cho kh·ªèe.',
            icon: 'üèÅ'
          },
          {
            time: '19:00',
            title: 'D·∫°o B·∫øn Ninh Ki·ªÅu',
            desc: 'Ra b·ªù k√® h√≥ng gi√≥, ng·∫Øm t∆∞·ª£ng B√°c H·ªì, C·∫ßu T√¨nh Y√™u.',
            icon: 'üåÉ'
          },
          {
            time: '20:30',
            title: 'ƒÇn T·ªëi Nh·∫π',
            desc: 'B√∫n n∆∞·ªõc l√®o ho·∫∑c H·ªß ti·∫øu g√µ khuya.',
            icon: 'üçú'
          }
        ],
        1: [
          // Day 1: 31/1
          {
            time: '09:00',
            title: 'Cafe S√°ng',
            desc: 'Ng·ªß n∆∞·ªõng x√≠u r·ªìi ƒëi cafe v·ª£t/view s√¥ng l·∫•y l·∫°i nƒÉng l∆∞·ª£ng.',
            icon: '‚òï'
          },
          {
            time: '11:30',
            title: 'L·∫©u V·ªãt C√¢y Tr·ª©ng C√°',
            desc: 'ƒÇn tr∆∞a m√≥n n√†y l√† ƒë√∫ng b√†i h·ªìi s·ª©c.',
            icon: 'üç≤'
          },
          { time: '13:30', title: 'Nh√† C·ªï B√¨nh Th·ªßy', desc: 'Tham quan nh√† c·ªï.', icon: 'üèõÔ∏è' },
          {
            time: '15:00',
            title: 'C·ªìn S∆°n (Option)',
            desc: 'Ti·ªán ƒë∆∞·ªùng ƒëi lu√¥n. Xem c√° l√≥c bay, ƒëi c·∫ßu kh·ªâ. N·∫øu m·ªát th√¨ b·ªè qua.',
            icon: 'üêü',
            isOptional: true
          },
          {
            time: '17:00',
            title: 'B√°nh C·ªëng C√¥ √öt',
            desc: 'V·ªÅ trung t√¢m ƒÉn x·∫ø m√≥n n√†y.',
            icon: 'ü•ü'
          },
          {
            time: '19:30',
            title: 'Ch·ª£ ƒê√™m & Ch·ª£ C·ªï',
            desc: 'ƒêi d·∫°o ch·ª£ ƒë√™m T√¢y ƒê√¥, mua s·∫Øm linh tinh.',
            icon: 'üõçÔ∏è'
          }
        ],
        2: [
          // Day 2: 1/2
          {
            time: '05:30',
            title: 'Ch·ª£ N·ªïi C√°i RƒÉng',
            desc: 'ƒêi s·ªõm. Thu√™ 1 ghe ri√™ng cho 3 ng∆∞·ªùi.',
            icon: 'üö§'
          },
          {
            time: '07:00',
            title: 'ƒÇn S√°ng tr√™n Ghe',
            desc: 'Pizza h·ªß ti·∫øu + Tr√°i c√¢y.',
            icon: 'üçç'
          },
          {
            time: '11:30',
            title: 'Nem N∆∞·ªõng C√¥ Thu',
            desc: 'ƒê∆∞·ªùng Ph·∫°m H√πng (C√°i RƒÉng). ƒÇn tr∆∞a ti·ªán ƒë∆∞·ªùng v·ªÅ.',
            icon: 'ü•ì'
          },
          { time: '14:00', title: 'Ng·ªß Tr∆∞a', desc: 'V·ªÅ kh√°ch s·∫°n tr√°nh n·∫Øng.', icon: 'üõå' },
          { time: '18:00', title: 'L·∫©u M·∫Øm Ki·ªÅu Trinh', desc: 'M√≥n ch√≠nh bu·ªïi t·ªëi.', icon: 'üç≤' },
          {
            time: '20:30',
            title: 'Ph·ªë N∆∞·ªõng 102',
            desc: 'TƒÉng 2: Ng·ªìi lai rai t·ªõi b·∫øn.',
            icon: 'üçª'
          }
        ],
        3: [
          // Day 3: 2/2
          { time: '08:00', title: 'Cafe & Checkout', desc: 'Cafe s√°ng, tr·∫£ ph√≤ng.', icon: '‚òï' },
          {
            time: '10:30',
            title: 'V·ªÅ S√†i G√≤n',
            desc: 'L√™n ƒë∆∞·ªùng v·ªÅ. K·∫øt th√∫c h√†nh tr√¨nh.',
            icon: 'üîô'
          }
        ]
      };

      // --- Core Functions ---

      function switchDay(day) {
        document.querySelectorAll('[id^="tab-day"]').forEach((btn) => {
          btn.className =
            'px-4 py-2 rounded font-bold transition bg-slate-100 text-slate-600 border-2 border-transparent whitespace-nowrap';
        });
        const activeBtn = document.getElementById(`tab-day${day}`);
        activeBtn.className =
          'px-4 py-2 rounded font-bold transition bg-amber-600 text-white shadow-md border-2 border-amber-600 whitespace-nowrap';

        const container = document.getElementById('timeline-content');
        container.innerHTML = '';

        const data = itineraryData[day];
        const accentColor = 'amber';

        data.forEach((item, index) => {
          const isLast = index === data.length - 1;
          const optionalClass = item.isOptional ? 'item-optional' : '';

          const html = `
                    <div class="relative pl-8 ${isLast ? '' : 'pb-8'}">
                        ${!isLast ? `<div class="absolute left-[-11px] top-2 h-full w-0.5 bg-${accentColor}-200"></div>` : ''}
                        <div class="absolute left-[-24px] top-0 flex h-8 w-8 items-center justify-center rounded-full bg-white border-2 border-${accentColor}-500 text-lg z-10 shadow-sm">
                            ${item.icon}
                        </div>
                        <div class="group relative rounded bg-white p-4 border border-slate-200 hover:shadow-md transition-all duration-200 hover:border-${accentColor}-400 ${optionalClass}">
                            <span class="inline-block px-2 py-0.5 mb-2 text-xs font-bold text-${accentColor}-700 bg-${accentColor}-100 rounded">
                                ${item.time}
                            </span>
                            <h3 class="text-lg font-bold text-slate-800">${item.title}</h3>
                            <p class="mt-1 text-slate-600 text-sm leading-relaxed">${item.desc}</p>
                        </div>
                    </div>
                `;
          container.innerHTML += html;
        });
      }

      function renderFood(filterType) {
        const grid = document.getElementById('food-grid');
        grid.innerHTML = '';
        const filtered =
          filterType === 'all' ? foodData : foodData.filter((f) => f.type === filterType);

        filtered.forEach((item) => {
          const fallbackUrl = `https://via.placeholder.com/600x400/cbd5e1/475569?text=${encodeURIComponent(item.name)}`;
          let linksHtml = '';
          if (item.mapLink)
            linksHtml += `<a href="${item.mapLink}" target="_blank" class="btn-icon bg-amber-100 text-amber-700 px-3 py-1.5 rounded-md text-xs font-bold hover:bg-amber-200">Ch·ªâ ƒê∆∞·ªùng üó∫Ô∏è</a>`;
          if (item.tiktok)
            linksHtml += `<a href="${item.tiktok}" target="_blank" class="btn-icon bg-black text-white px-3 py-1.5 rounded-md text-xs font-bold hover:bg-gray-800 ml-2">TikTok üéµ</a>`;

          const card = `
                    <div class="food-card bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden hover:shadow-xl transition duration-300 flex flex-col h-full group relative">
                        <div class="h-48 overflow-hidden relative bg-slate-200 img-skeleton">
                             <img src="${item.img}" alt="${item.name}" 
                                class="food-card-img w-full h-full object-cover opacity-0 transition-opacity duration-300"
                                onload="this.classList.remove('opacity-0'); this.parentElement.classList.remove('img-skeleton');"
                                onerror="this.onerror=null; this.src='${fallbackUrl}'; this.classList.remove('opacity-0'); this.parentElement.classList.remove('img-skeleton');">
                        </div>
                        <div class="p-5 flex flex-col flex-grow">
                            <h4 class="text-lg font-bold text-slate-800 mb-1 group-hover:text-amber-600 transition">${item.name}</h4>
                            <p class="text-xs text-slate-500 mb-2 font-medium italic truncate">üìç ${item.address}</p>
                            <p class="text-sm text-slate-600 mb-4 flex-grow line-clamp-3">${item.desc}</p>
                            <div class="flex flex-wrap gap-2 mb-3">${linksHtml}</div>
                            <div class="text-xs text-slate-400 border-t pt-3 flex items-center justify-between mt-auto">
                                <span class="text-amber-600 font-bold">${item.type === 'main' ? 'M√≥n Ch√≠nh' : 'ƒÇn V·∫∑t'}</span>
                                <button onclick="getFoodReview('${item.name}')" class="text-amber-600 hover:text-amber-700 font-bold text-xs flex items-center gap-1 bg-amber-50 px-2 py-1 rounded-full border border-amber-200">AI Review ‚ú®</button>
                            </div>
                        </div>
                    </div>
                `;
          grid.innerHTML += card;
        });
      }

      function filterFood(type) {
        document.querySelectorAll('.food-filter-btn').forEach((btn) => {
          btn.classList.remove('bg-slate-800', 'text-white');
          btn.classList.add('bg-white', 'text-slate-600', 'border', 'border-slate-300');
        });
        event.target.classList.remove('bg-white', 'text-slate-600', 'border', 'border-slate-300');
        event.target.classList.add('bg-slate-800', 'text-white');
        renderFood(type);
      }

      function scrollToSection(id) {
        const el = document.getElementById(id);
        const navHeight = 80;
        const y = el.getBoundingClientRect().top + window.pageYOffset - navHeight;
        window.scrollTo({ top: y, behavior: 'smooth' });
        document.getElementById('mobile-nav').classList.add('hidden');
      }

      function toggleMobileNav() {
        document.getElementById('mobile-nav').classList.toggle('hidden');
      }

      // --- Chat & AI ---
      function toggleChat() {
        document.getElementById('chatWindow').style.display =
          document.getElementById('chatWindow').style.display === 'flex' ? 'none' : 'flex';
      }

      async function sendMessage() {
        const input = document.getElementById('userQuery');
        const messages = document.getElementById('chatMessages');
        const text = input.value.trim();
        if (!text) return;
        messages.innerHTML += `<div class="message user">${text}</div>`;
        input.value = '';
        messages.scrollTop = messages.scrollHeight;

        const loadingId = 'loading-' + Date.now();
        messages.innerHTML += `<div class="message ai typing-indicator" id="${loadingId}"><span></span><span></span><span></span></div>`;
        messages.scrollTop = messages.scrollHeight;

        const systemPrompt =
          'B·∫°n l√† Th·ªï ƒê·ªãa C·∫ßn Th∆°, chuy√™n gia ph∆∞·ª£t ƒë∆∞·ªùng N2. T∆∞ v·∫•n ng·∫Øn g·ªçn, vui v·∫ª.';
        const response = await callGemini(text, systemPrompt);

        document.getElementById(loadingId).remove();
        messages.innerHTML += `<div class="message ai">${marked.parse(response)}</div>`;
        messages.scrollTop = messages.scrollHeight;
      }

      function handleKeyPress(e) {
        if (e.key === 'Enter') sendMessage();
      }

      async function getFoodReview(foodName) {
        const modal = document.getElementById('reviewModal');
        const content = document.getElementById('reviewContent');
        document.getElementById('reviewTitle').innerText = `Review: ${foodName}`;
        content.innerHTML = `<div class="flex justify-center p-10"><div class="typing-indicator"><span></span><span></span><span></span></div></div>`;
        modal.style.display = 'flex';
        const response = await callGemini(
          `Review m√≥n ${foodName} ·ªü C·∫ßn Th∆°.`,
          'Chuy√™n gia ·∫©m th·ª±c mi·ªÅn T√¢y. Review h·∫•p d·∫´n.'
        );
        content.innerHTML = marked.parse(response);
      }

      function closeReview(e) {
        if (!e || e.target.id === 'reviewModal' || e.target.tagName === 'BUTTON')
          document.getElementById('reviewModal').style.display = 'none';
      }

      // --- Init ---
      document.addEventListener('DOMContentLoaded', () => {
        switchDay(0); // Load Day 0 first
        renderFood('all');

        new Chart(document.getElementById('budgetChart'), {
          type: 'bar',
          data: {
            labels: ['Kh√°ch S·∫°n', 'ƒÇn U·ªëng', 'XƒÉng Xe', 'V√©/Ghe', 'D·ª± Ph√≤ng'],
            datasets: [
              {
                label: 'VND',
                data: [1500000, 4200000, 600000, 700000, 600000],
                backgroundColor: ['#64748B', '#F59E0B', '#10B981', '#06B6D4', '#94A3B8'],
                borderRadius: 4
              }
            ]
          },
          options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
              y: { beginAtZero: true, ticks: { callback: (v) => (v / 1000000).toFixed(1) + ' tr' } }
            },
            plugins: { legend: { display: false } }
          }
        });
      });
    </script>
  </body>
</html>
